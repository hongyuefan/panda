{"version":3,"sources":["webpack:///static/js/9.beedd355fdf0d2d31b06.js","webpack:///./src/pages/lottery.vue","webpack:///./~/_babel-runtime@6.26.0@babel-runtime/helpers/extends.js?6521********","webpack:///lottery.vue","webpack:///./src/pages/lottery.vue?8ac0","webpack:///./src/pages/lottery.vue?dd4f","webpack:///./src/pages/lottery.vue?be0d"],"names":["webpackJsonp","182","module","exports","__webpack_require__","injectStyle","ssrContext","Component","188","__esModule","_assign","_assign2","obj","default","target","i","arguments","length","source","key","Object","prototype","hasOwnProperty","call","262","__webpack_exports__","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","n","__WEBPACK_IMPORTED_MODULE_1_vuex__","__WEBPACK_IMPORTED_MODULE_2_mint_ui__","__WEBPACK_IMPORTED_MODULE_3__api__","data","confirmTitle","confirmMessage","agreementText","price","isLottery","time60s","timer","mounted","_this","this","$store","dispatch","params","page","perpage","order","sort","amount","type","txhash","luckdrawHash","cb","err","info","message","status","position","duration","watch","setInterval","clearInterval","computed","english","states","user","balance","transaction","api","components","MessageBox","Toast","methods","lotteryFn","confirm","then","action","spend","catch","resultFn","getLuckresult","id","memberId","protocol","$router","push","name","getProtocolAgreement","283","version","sources","names","mappings","file","sourcesContent","sourceRoot","321","content","locals","389","render","_vm","_h","$createElement","_c","_self","attrs","fixed","slot","to","icon","_v","staticClass","nativeOn","click","$event","on","staticRenderFns"],"mappings":"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","file":"static/js/9.beedd355fdf0d2d31b06.js","sourcesContent":["webpackJsonp([9],{\n\n/***/ 182:\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(321)\n}\nvar Component = __webpack_require__(82)(\n  /* script */\n  __webpack_require__(262),\n  /* template */\n  __webpack_require__(389),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-0a5777e0\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 188:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nexports.__esModule = true;\n\nvar _assign = __webpack_require__(85);\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n/***/ }),\n\n/***/ 262:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__ = __webpack_require__(188);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vuex__ = __webpack_require__(83);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_mint_ui__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_mint_ui___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_mint_ui__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__api__ = __webpack_require__(42);\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  data: function data() {\n    return {\n      confirmTitle: '提示',\n      confirmMessage: '确定执行此操作吗？',\n      agreementText: '',\n      price: 10, // 需要花费多少来抽奖\n      isLottery: true,\n      time60s: 0,\n      timer: null\n    };\n  },\n  mounted: function mounted() {\n    // 进抽奖页面一次，查询一次抽奖结果，给lotteryNum 加 1\n    var _this = this;\n    // this.getProtocolAgreement()\n    // if (this.lotteryNum === 5 || this.lotteryNum > 5) {\n    //   Toast({\n    //     message: '抽奖失败！',\n    //     position: 'middle',\n    //     duration: 2000\n    //   })\n    //   this.$store.dispatch('setLotteryNum', 0)\n    // }\n    // else {\n    // let n = this.lotteryNum + 1\n    // this.$store.dispatch('setLotteryNum', n)\n    this.$store.dispatch('getTransaction', {\n      params: {\n        page: 0,\n        perpage: 10,\n        order: 'desc',\n        sort: 'amount',\n        amount: '',\n        type: 6,\n        txhash: _this.luckdrawHash\n      },\n      cb: function cb(err, data) {\n        // eslint-disable-line\n        if (data.info.length) {\n          __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"])({\n            message: data.info[0].status,\n            position: 'middle',\n            duration: 2000\n          });\n        }\n      }\n    });\n    // }\n  },\n\n  watch: {\n    isLottery: function isLottery() {\n      var _this = this;\n      if (!this.isLottery) {\n        this.timer = setInterval(function () {\n          if (_this.time60s > 0) {\n            _this.time60s = _this.time60s - 1;\n          } else {\n            clearInterval(_this.timer);\n            _this.timer = null;\n            _this.time60s = 0;\n            _this.isLottery = true;\n          }\n        }, 1000);\n      }\n    }\n  },\n  computed: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({}, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1_vuex__[\"a\" /* mapState */])({\n    english: function english(states) {\n      return states.english;\n    },\n    user: function user(states) {\n      return states.user;\n    },\n    balance: function balance(states) {\n      return states.balance;\n    },\n    // lotteryNum: states => states.lotteryNum,\n    transaction: function transaction(states) {\n      return states.api.transaction;\n    },\n    luckdrawHash: function luckdrawHash(states) {\n      return states.api.luckdrawHash;\n    }\n  })),\n  components: {\n    MessageBox: __WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"MessageBox\"],\n    Toast: __WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"]\n  },\n  methods: {\n    lotteryFn: function lotteryFn() {\n      var _this = this;\n      // 点击抽奖，会返回是否上链成功，但并不一定交易成功，之后再查看宠物界面，产生则抽奖完成\n      __WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"MessageBox\"].confirm('您确定花费' + _this.price + '个币进行抽奖吗？', '').then(function (action) {\n        // 比较花费的和当前余额，如果余额不够，提示余额不足，如果可以则进行交易\n        if (_this.balance < _this.price) {\n          __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"])({\n            message: '余额不足，请充值后再试！',\n            position: 'middle',\n            duration: 2000\n          });\n        } else {\n          // 进行抽奖交易\n          _this.$store.dispatch('getLuckdrawHash', {\n            params: {\n              // 需要跟后台沟通传参\n              spend: _this.price\n            },\n            cb: function cb(err, data) {\n              // eslint-disable-line\n              if (data) {\n                _this.$store.dispatch('setBalance', _this.balance - _this.price);\n                __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"])({\n                  message: '抽奖完成，请一分钟后查询结果！',\n                  position: 'middle',\n                  duration: 2000\n                });\n                _this.isLottery = false;\n                _this.time60s = 60;\n                // 更新首页我的熊猫数据\n              } else if (err) {\n                __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"])({\n                  message: err.message,\n                  position: 'middle',\n                  duration: 2000\n                });\n              }\n            }\n          });\n        }\n      }).catch(function (action) {\n        // 关闭\n      });\n    },\n    resultFn: function resultFn() {\n      var _this = this;\n      __WEBPACK_IMPORTED_MODULE_3__api__[\"a\" /* default */].getLuckresult({\n        id: _this.user.memberId\n      }).then(function (data) {\n        // eslint-disable-line\n        if (data) {\n          __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"])({\n            message: data.message,\n            position: 'middle',\n            duration: 2000\n          });\n          _this.isLottery = true;\n        }\n      }).catch(function (err) {\n        // eslint-disable-line\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_mint_ui__[\"Toast\"])({\n          message: err.message,\n          position: 'middle',\n          duration: 2000\n        });\n      });\n    },\n    protocol: function protocol() {\n      this.$router.push({ name: 'Agreement' });\n    },\n    getProtocolAgreement: function getProtocolAgreement() {\n      this.$store.dispatch('getAgreement', {\n        params: {\n          // 抽奖的协议，需要跟后台商量传什么参数\n          type: 'luckdraw'\n        }\n      });\n    }\n  }\n});\n\n/***/ }),\n\n/***/ 283:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(176)(true);\n// imports\n\n\n// module\nexports.push([module.i, \".lottery[data-v-0a5777e0]{margin:200px auto 10px}\", \"\", {\"version\":3,\"sources\":[\"/Users/huigeek/lxh/myPro/github/Hcat/src/pages/lottery.vue\"],\"names\":[],\"mappings\":\"AACA,0BACE,sBAAwB,CACzB\",\"file\":\"lottery.vue\",\"sourcesContent\":[\"\\n.lottery[data-v-0a5777e0] {\\n  margin: 200px auto 10px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 321:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(283);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(177)(\"62b310ee\", content, true, {});\n\n/***/ }),\n\n/***/ 389:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('mt-header', {\n    attrs: {\n      \"fixed\": \"\"\n    }\n  }, [_c('router-link', {\n    attrs: {\n      \"slot\": \"left\",\n      \"to\": \"/home\"\n    },\n    slot: \"left\"\n  }, [_c('mt-button', {\n    attrs: {\n      \"icon\": \"back\"\n    }\n  }, [_vm._v(\"返回\")])], 1)], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"tac lottery\"\n  }, [(_vm.isLottery) ? _c('div', [_c('mt-button', {\n    attrs: {\n      \"type\": \"default\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        return _vm.lotteryFn($event)\n      }\n    }\n  }, [(!_vm.english) ? _c('span', [_vm._v(\"抽奖\")]) : _c('span', [_vm._v(\"Lottery\")])])], 1) : _c('div', [_c('mt-button', {\n    attrs: {\n      \"type\": \"default\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        return _vm.resultFn($event)\n      }\n    }\n  }, [(!_vm.english) ? _c('span', [_vm._v(\"查询结果\")]) : _c('span', [_vm._v(\"Lottery\")])])], 1)]), _vm._v(\" \"), _c('div', {\n    staticClass: \"tac\"\n  }, [_c('span', {\n    on: {\n      \"click\": _vm.protocol\n    }\n  }, [(!_vm.english) ? _c('span', [_vm._v(\"查看协议内容\")]) : _c('span', [_vm._v(\"Protocol content\")])])])], 1)\n},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/9.beedd355fdf0d2d31b06.js","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/_extract-text-webpack-plugin@2.1.2@extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a5777e0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=styles&index=0!../../node_modules/_maroon-loader@1.0.9@maroon-loader/lib/loader.js??ref--0!./lottery.vue\")\n}\nvar Component = require(\"!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=script&index=0!../../node_modules/_maroon-loader@1.0.9@maroon-loader/lib/loader.js??ref--0!./lottery.vue\"),\n  /* template */\n  require(\"!!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0a5777e0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"}}!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=template&index=0!../../node_modules/_maroon-loader@1.0.9@maroon-loader/lib/loader.js??ref--0!./lottery.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-0a5777e0\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/lottery.vue\n// module id = 182\n// module chunks = 9","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_babel-runtime@6.26.0@babel-runtime/helpers/extends.js\n// module id = 188\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10","<template>\n  <div>\n    <mt-header fixed>\n      <router-link to=\"/home\" slot=\"left\">\n        <mt-button icon=\"back\">返回</mt-button>\n      </router-link>\n    </mt-header>\n    <div class=\"tac lottery\">\n      <div v-if=\"isLottery\">\n        <mt-button \n          type=\"default\" \n          @click.native=\"lotteryFn\">\n          <span v-if=\"!english\">抽奖</span>\n          <span v-else>Lottery</span>\n        </mt-button>\n      </div>\n      <div v-else>\n        <mt-button \n          type=\"default\" \n          @click.native=\"resultFn\">\n          <span v-if=\"!english\">查询结果</span>\n          <span v-else>Lottery</span>\n        </mt-button>\n      </div>\n    </div>\n    <div class=\"tac\">\n      <span @click=\"protocol\">\n        <span v-if=\"!english\">查看协议内容</span>\n        <span v-else>Protocol content</span>\n      </span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { MessageBox, Toast } from 'mint-ui'\nimport service from '@/api'\nexport default {\n  data () {\n    return {\n      confirmTitle: '提示',\n      confirmMessage: '确定执行此操作吗？',\n      agreementText: '',\n      price: 10, // 需要花费多少来抽奖\n      isLottery: true,\n      time60s: 0,\n      timer: null\n    }\n  },\n  mounted () {\n    // 进抽奖页面一次，查询一次抽奖结果，给lotteryNum 加 1\n    let _this = this\n    // this.getProtocolAgreement()\n    // if (this.lotteryNum === 5 || this.lotteryNum > 5) {\n    //   Toast({\n    //     message: '抽奖失败！',\n    //     position: 'middle',\n    //     duration: 2000\n    //   })\n    //   this.$store.dispatch('setLotteryNum', 0)\n    // }\n    // else {\n      // let n = this.lotteryNum + 1\n      // this.$store.dispatch('setLotteryNum', n)\n    this.$store.dispatch('getTransaction', {\n      params: {\n        page: 0,\n        perpage: 10,\n        order: 'desc',\n        sort: 'amount',\n        amount: '',\n        type: 6,\n        txhash: _this.luckdrawHash\n      },\n      cb: function (err, data) { // eslint-disable-line\n        if (data.info.length) {\n          Toast({\n            message: data.info[0].status,\n            position: 'middle',\n            duration: 2000\n          })\n        }\n      }\n    })\n    // }\n  },\n  watch: {\n    isLottery: function () {\n      let _this = this\n      if (!this.isLottery) {\n        this.timer = setInterval(function () {\n          if (_this.time60s > 0) {\n            _this.time60s = _this.time60s - 1\n          }\n          else {\n            clearInterval(_this.timer)\n            _this.timer = null\n            _this.time60s = 0\n            _this.isLottery = true\n          }\n        }, 1000)\n      }\n    }\n  },\n  computed: {\n    ...mapState({\n      english: states => states.english,\n      user: states => states.user,\n      balance: states => states.balance,\n      // lotteryNum: states => states.lotteryNum,\n      transaction: states => states.api.transaction,\n      luckdrawHash: states => states.api.luckdrawHash\n    })\n  },\n  components: {\n    MessageBox,\n    Toast\n  },\n  methods: {\n    lotteryFn () {\n      let _this = this\n      // 点击抽奖，会返回是否上链成功，但并不一定交易成功，之后再查看宠物界面，产生则抽奖完成\n      MessageBox.confirm('您确定花费' + _this.price + '个币进行抽奖吗？', '').then(action => {\n        // 比较花费的和当前余额，如果余额不够，提示余额不足，如果可以则进行交易\n        if (_this.balance < _this.price) {\n          Toast({\n            message: '余额不足，请充值后再试！',\n            position: 'middle',\n            duration: 2000\n          })\n        }\n        else {\n          // 进行抽奖交易\n          _this.$store.dispatch('getLuckdrawHash', {\n            params: {\n              // 需要跟后台沟通传参\n              spend: _this.price\n            },\n            cb: function (err, data) { // eslint-disable-line\n              if (data) {\n                _this.$store.dispatch('setBalance', _this.balance - _this.price)\n                Toast({\n                  message: '抽奖完成，请一分钟后查询结果！',\n                  position: 'middle',\n                  duration: 2000\n                })\n                _this.isLottery = false\n                _this.time60s = 60\n                // 更新首页我的熊猫数据\n              }\n              else if (err) {\n                Toast({\n                  message: err.message,\n                  position: 'middle',\n                  duration: 2000\n                })\n              }\n            }\n          })\n        }\n      }).catch(action => {\n        // 关闭\n      })\n    },\n    resultFn () {\n      let _this = this\n      service.getLuckresult({\n        id: _this.user.memberId\n      }).then((data) => { // eslint-disable-line\n        if (data) {\n          Toast({\n            message: data.message,\n            position: 'middle',\n            duration: 2000\n          })\n          _this.isLottery = true\n        }\n      }).catch((err) => { // eslint-disable-line\n        Toast({\n          message: err.message,\n          position: 'middle',\n          duration: 2000\n        })\n      })\n    },\n    protocol () {\n      this.$router.push({name: 'Agreement'})\n    },\n    getProtocolAgreement () {\n      this.$store.dispatch('getAgreement', {\n        params: {\n          // 抽奖的协议，需要跟后台商量传什么参数\n          type: 'luckdraw'\n        }\n      })\n    }\n  }\n}\n\n</script>\n\n<style lang=\"scss\" scoped>\n.lottery {\n  margin: 200px auto 10px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// lottery.vue?19bf5fe1","exports = module.exports = require(\"../../node_modules/_css-loader@0.28.11@css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".lottery[data-v-0a5777e0]{margin:200px auto 10px}\", \"\", {\"version\":3,\"sources\":[\"/Users/huigeek/lxh/myPro/github/Hcat/src/pages/lottery.vue\"],\"names\":[],\"mappings\":\"AACA,0BACE,sBAAwB,CACzB\",\"file\":\"lottery.vue\",\"sourcesContent\":[\"\\n.lottery[data-v-0a5777e0] {\\n  margin: 200px auto 10px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_css-loader@0.28.11@css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-0a5777e0\",\"scoped\":true,\"hasInlineConfig\":false}!./~/_sass-loader@6.0.7@sass-loader/lib/loader.js?{\"sourceMap\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./~/_maroon-loader@1.0.9@maroon-loader/lib/loader.js?{\"name\":\"maroon\",\"mode\":\"dev\"}!./src/pages/lottery.vue\n// module id = 283\n// module chunks = 9","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/_css-loader@0.28.11@css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a5777e0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/_sass-loader@6.0.7@sass-loader/lib/loader.js?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!../../node_modules/_maroon-loader@1.0.9@maroon-loader/lib/loader.js?{\\\"name\\\":\\\"maroon\\\",\\\"mode\\\":\\\"dev\\\"}!./lottery.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/_vue-style-loader@3.1.2@vue-style-loader/lib/addStylesClient.js\")(\"62b310ee\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_extract-text-webpack-plugin@2.1.2@extract-text-webpack-plugin/loader.js?{\"omit\":1,\"remove\":true}!./~/_vue-style-loader@3.1.2@vue-style-loader!./~/_css-loader@0.28.11@css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-0a5777e0\",\"scoped\":true,\"hasInlineConfig\":false}!./~/_sass-loader@6.0.7@sass-loader/lib/loader.js?{\"sourceMap\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./~/_maroon-loader@1.0.9@maroon-loader/lib/loader.js?{\"name\":\"maroon\",\"mode\":\"dev\"}!./src/pages/lottery.vue\n// module id = 321\n// module chunks = 9","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('mt-header', {\n    attrs: {\n      \"fixed\": \"\"\n    }\n  }, [_c('router-link', {\n    attrs: {\n      \"slot\": \"left\",\n      \"to\": \"/home\"\n    },\n    slot: \"left\"\n  }, [_c('mt-button', {\n    attrs: {\n      \"icon\": \"back\"\n    }\n  }, [_vm._v(\"返回\")])], 1)], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"tac lottery\"\n  }, [(_vm.isLottery) ? _c('div', [_c('mt-button', {\n    attrs: {\n      \"type\": \"default\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        return _vm.lotteryFn($event)\n      }\n    }\n  }, [(!_vm.english) ? _c('span', [_vm._v(\"抽奖\")]) : _c('span', [_vm._v(\"Lottery\")])])], 1) : _c('div', [_c('mt-button', {\n    attrs: {\n      \"type\": \"default\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        return _vm.resultFn($event)\n      }\n    }\n  }, [(!_vm.english) ? _c('span', [_vm._v(\"查询结果\")]) : _c('span', [_vm._v(\"Lottery\")])])], 1)]), _vm._v(\" \"), _c('div', {\n    staticClass: \"tac\"\n  }, [_c('span', {\n    on: {\n      \"click\": _vm.protocol\n    }\n  }, [(!_vm.english) ? _c('span', [_vm._v(\"查看协议内容\")]) : _c('span', [_vm._v(\"Protocol content\")])])])], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-loader@12.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-0a5777e0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"}}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=template&index=0!./~/_maroon-loader@1.0.9@maroon-loader/lib/loader.js?{\"name\":\"maroon\",\"mode\":\"dev\"}!./src/pages/lottery.vue\n// module id = 389\n// module chunks = 9"],"sourceRoot":""}